/* This file was generated by the Pallene compiler. Do not edit by hand" */
/* Indentation and formatting courtesy of pallene/C.lua */

#include "pallene_core.h"

/* ------- */
/* Records */
/* ------- */

/* ------------------- */
/* Function Prototypes */
/* ------------------- */

static void function_01(
    lua_State *L,
    Udata *G,
    StackValue *base
);
static Table * function_02(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2  /* M */
);
static lua_Integer function_03(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* i */
    lua_Integer x2  /* N */
);
static void function_04(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3  /* cells */
);
static void function_05(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3, /* cells */
    Table *x4, /* shape */
    lua_Integer x5, /* top */
    lua_Integer x6  /* left */
);
static void function_06(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3, /* curr_cells */
    Table *x4  /* next_cells */
);

/* ------------------------ */
/* Function Implementations */
/* ------------------------ */

/* $init */
static void function_01(
    lua_State *L,
    Udata *G,
    StackValue *base
) {
    	
}

/* new_canvas benchmarks/conway/pallene.pln:5 */
static Table * function_02(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2  /* M */
) {
    luaD_checkstack(L, 2);
    Table *x3; /* t */
    lua_Integer x4; /* i */
    Table *x5; /* line */
    lua_Integer x6; /* j */
    	
    x3 = pallene_createtable(L, 0, 0);
    sethvalue(L, s2v(base + 0), x3);
    luaC_condGC(L, L->top = base + 1, (void)0);
    // hoist by range analysis
    pallene_renormalize_array(L, x3, x1, 12);
    PALLENE_INT_FOR_LOOP_BEGIN(x4, 1, x1, 1)
    {
        x5 = pallene_createtable(L, 0, 0);
        sethvalue(L, s2v(base + 1), x5);
        luaC_condGC(L, L->top = base + 2, (void)0);
        //hoist by range analysis
        pallene_renormalize_array(L, x5, x2, 10);
        PALLENE_INT_FOR_LOOP_BEGIN(x6, 1, x2, 1)
        {
            {
                TValue *slot = &x5->array[x6 - 1];
                setivalue(slot, 0);
            }
        }
        PALLENE_INT_FOR_LOOP_END
        {
            TValue *slot = &x3->array[x4 - 1];
            sethvalue(L, slot, x5);
            pallene_barrierback_collectable_child(L, x3, x5);
        }
    }
    PALLENE_INT_FOR_LOOP_END
    return x3;
}

/* wrap benchmarks/conway/pallene.pln:18 */
// by range analysis we know that the 
// value will always be less than N
static lua_Integer function_03(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* i */
    lua_Integer x2  /* N */
) {
    lua_Integer x3;
    lua_Integer x4;
    lua_Integer x5;
    	
    x5 = intop(-, x1, 1);
    x4 = pallene_int_modi(L, x5, x2, 19);
    x3 = intop(+, x4, 1);
    return x3;
}

/* draw benchmarks/conway/pallene.pln:23 */
static void function_04(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3  /* cells */
) {
    luaD_checkstack(L, 2);
    TString *x4; /* out */
    lua_Integer x5; /* i */
    Table *x6; /* cellsi */
    lua_Integer x7; /* j */
    int x8;
    lua_Integer x9;
    TString *x10;
    TString *x11;
    	
    x4 = tsvalue(&G->uv[0].uv);
    setsvalue(L, s2v(base + 0), x4);
    //for hoist
    pallene_renormalize_array(L, x3, x1, 26);
    PALLENE_INT_FOR_LOOP_BEGIN(x5, 1, x1, 1)
    {
        {
            TValue *slot = &x3->array[x5 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    26, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x6 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 1), x6);
        {
            TString *ss[2];
            ss[0] = x4;
            ss[1] = tsvalue(&G->uv[1].uv); ;
            x4 = pallene_string_concatN(L, 2, ss);
        }
        setsvalue(L, s2v(base + 0), x4);
        luaC_condGC(L, L->top = base + 2, (void)0);
        // for hoist
        pallene_renormalize_array(L, x6, x2, 29);
        PALLENE_INT_FOR_LOOP_BEGIN(x7, 1, x2, 1)
        {
            {
                TValue *slot = &x6->array[x7 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        29, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x9 = ivalue(slot);
            }
            x8 = (x9 != 0);
            if (x8) {
                x10 = tsvalue(&G->uv[2].uv);
                {
                    TString *ss[2];
                    ss[0] = x4;
                    ss[1] = x10; ;
                    x4 = pallene_string_concatN(L, 2, ss);
                }
                setsvalue(L, s2v(base + 0), x4);
                luaC_condGC(L, L->top = base + 1, (void)0);
            } else {
                x11 = tsvalue(&G->uv[3].uv);
                {
                    TString *ss[2];
                    ss[0] = x4;
                    ss[1] = x11; ;
                    x4 = pallene_string_concatN(L, 2, ss);
                }
                setsvalue(L, s2v(base + 0), x4);
                luaC_condGC(L, L->top = base + 1, (void)0);
            }
        }
        PALLENE_INT_FOR_LOOP_END
        {
            TString *ss[2];
            ss[0] = x4;
            ss[1] = tsvalue(&G->uv[4].uv); ;
            x4 = pallene_string_concatN(L, 2, ss);
        }
        setsvalue(L, s2v(base + 0), x4);
        luaC_condGC(L, L->top = base + 1, (void)0);
    }
    PALLENE_INT_FOR_LOOP_END
    pallene_io_write(L, x4);
}

/* spawn benchmarks/conway/pallene.pln:41 */
static void function_05(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3, /* cells */
    Table *x4, /* shape */
    lua_Integer x5, /* top */
    lua_Integer x6  /* left */
) {
    luaD_checkstack(L, 2);
    lua_Integer x7; /* i */
    lua_Integer x8; /* ci */
    Table *x9; /* shape_row */
    Table *x10; /* cell_row */
    lua_Integer x11; /* j */
    lua_Integer x12; /* cj */
    lua_Integer x13;
    lua_Integer x14;
    lua_Integer x15;
    lua_Integer x16;
    lua_Integer x17;
    lua_Integer x18;
    lua_Integer x19;
    	
    if (x4->metatable) {
        pallene_runtime_array_metatable_error(L, 43);
    }
    x13 = luaH_getn(x4);
    //for hoist
    pallene_renormalize_array(L, x4, x13, 45);
    //constant hoist
    pallene_renormalize_array(L, x3, x1, 46);
    PALLENE_INT_FOR_LOOP_BEGIN(x7, 1, x13, 1)
    {
        x15 = intop(+, x7, x5);
        x14 = intop(-, x15, 1);
        {
            StackValue *old_stack = L->stack;
            x8 = function_03(L, G, base + 0, x14, x1);
            base = L->stack + (base - old_stack);
        }
        {
            TValue *slot = &x4->array[x7 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    45, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x9 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 0), x9);
        {
            TValue *slot = &x3->array[x8 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    46, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x10 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 1), x10);
        if (x9->metatable) {
            pallene_runtime_array_metatable_error(L, 47);
        }
        x16 = luaH_getn(x9);
        // for hoist
        pallene_renormalize_array(L, x9, x16, 49);
        //hoist by inlining wrap then range analysis
        pallene_renormalize_array(L, x10, x2, 49);
        PALLENE_INT_FOR_LOOP_BEGIN(x11, 1, x16, 1)
        {
            x18 = intop(+, x11, x6);
            x17 = intop(-, x18, 1);
            {
                StackValue *old_stack = L->stack;
                x12 = function_03(L, G, base + 2, x17, x2);
                base = L->stack + (base - old_stack);
            }
            {
                TValue *slot = &x9->array[x11 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        49, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x19 = ivalue(slot);
            }
            {
                TValue *slot = &x10->array[x12 - 1];
                setivalue(slot, x19);
            }
        }
        PALLENE_INT_FOR_LOOP_END
    }
    PALLENE_INT_FOR_LOOP_END
}

/* step benchmarks/conway/pallene.pln:55 */
static void function_06(
    lua_State *L,
    Udata *G,
    StackValue *base,
    lua_Integer x1, /* N */
    lua_Integer x2, /* M */
    Table *x3, /* curr_cells */
    Table *x4  /* next_cells */
) {
    luaD_checkstack(L, 4);
    lua_Integer x5; /* i2 */
    lua_Integer x6; /* i1 */
    lua_Integer x7; /* i3 */
    Table *x8; /* cells1 */
    Table *x9; /* cells2 */
    Table *x10; /* cells3 */
    Table *x11; /* next2 */
    lua_Integer x12; /* j2 */
    lua_Integer x13; /* j1 */
    lua_Integer x14; /* j3 */
    lua_Integer x15; /* c11 */
    lua_Integer x16; /* c12 */
    lua_Integer x17; /* c13 */
    lua_Integer x18; /* c21 */
    lua_Integer x19; /* c22 */
    lua_Integer x20; /* c23 */
    lua_Integer x21; /* c31 */
    lua_Integer x22; /* c32 */
    lua_Integer x23; /* c33 */
    lua_Integer x24; /* sum */
    lua_Integer x25;
    lua_Integer x26;
    lua_Integer x27;
    lua_Integer x28;
    lua_Integer x29;
    lua_Integer x30;
    lua_Integer x31;
    lua_Integer x32;
    lua_Integer x33;
    lua_Integer x34;
    int x35;
    // host by inline wrap and then range analysis
    pallene_renormalize_array(L, x3, x1, 61);
    // for hoist (safe by inline of wrap)
    pallene_renormalize_array(L, x3, x1, 62);
    // for hoist (safe by inline of wrap)
    pallene_renormalize_array(L, x4, x1, 65);
    PALLENE_INT_FOR_LOOP_BEGIN(x5, 1, x1, 1)
    {
        x25 = intop(-, x5, 1);
        {
            StackValue *old_stack = L->stack;
            x6 = function_03(L, G, base + 0, x25, x1);
            base = L->stack + (base - old_stack);
        }
        x26 = intop(+, x5, 1);
        {
            StackValue *old_stack = L->stack;
            x7 = function_03(L, G, base + 0, x26, x1);
            base = L->stack + (base - old_stack);
        }
        {
            TValue *slot = &x3->array[x6 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    61, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x8 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 0), x8);
        {
            TValue *slot = &x3->array[x5 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    62, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x9 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 1), x9);
        {
            TValue *slot = &x3->array[x7 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    63, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x10 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 2), x10);
        {
            TValue *slot = &x4->array[x5 - 1];
            if (PALLENE_UNLIKELY(!ttistable(slot))) {
                pallene_runtime_tag_check_error(L,
                    65, LUA_TTABLE, rawtt(slot),
                    "array element");
            }
            x11 = hvalue(slot);
        }
        sethvalue(L, s2v(base + 3), x11);
        // host by inline wrap and then range analysis
        pallene_renormalize_array(L, x8, x2, 71);
        // host by inline wrap and then range analysis
        pallene_renormalize_array(L, x9, x2, 71);
        // host by inline wrap and then range analysis
        pallene_renormalize_array(L, x10, x2, 71);
        //for hoist
        pallene_renormalize_array(L, x11, x2, 89);
        PALLENE_INT_FOR_LOOP_BEGIN(x12, 1, x2, 1)
        {
            x27 = intop(-, x12, 1);
            {
                StackValue *old_stack = L->stack;
                x13 = function_03(L, G, base + 4, x27, x2);
                base = L->stack + (base - old_stack);
            }
            x28 = intop(+, x12, 1);
            {
                StackValue *old_stack = L->stack;
                x14 = function_03(L, G, base + 4, x28, x2);
                base = L->stack + (base - old_stack);
            }
            {
                TValue *slot = &x8->array[x13 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        71, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x15 = ivalue(slot);
            }
            {
                
                TValue *slot = &x8->array[x12 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        72, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x16 = ivalue(slot);
            }
            {
                
                TValue *slot = &x8->array[x14 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        73, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x17 = ivalue(slot);
            }
            {
                
                TValue *slot = &x9->array[x13 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        75, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x18 = ivalue(slot);
            }
            {
                
                TValue *slot = &x9->array[x12 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        76, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x19 = ivalue(slot);
            }
            {
                
                TValue *slot = &x9->array[x14 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        77, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x20 = ivalue(slot);
            }
            {
                
                TValue *slot = &x10->array[x13 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        79, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x21 = ivalue(slot);
            }
            {
                
                TValue *slot = &x10->array[x12 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        80, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x22 = ivalue(slot);
            }
            {
                
                TValue *slot = &x10->array[x14 - 1];
                if (PALLENE_UNLIKELY(!ttisinteger(slot))) {
                    pallene_runtime_tag_check_error(L,
                        81, LUA_TNUMINT, rawtt(slot),
                        "array element");
                }
                x23 = ivalue(slot);
            }
            x34 = intop(+, x15, x16);
            x33 = intop(+, x34, x17);
            x32 = intop(+, x33, x18);
            x31 = intop(+, x32, x20);
            x30 = intop(+, x31, x21);
            x29 = intop(+, x30, x22);
            x24 = intop(+, x29, x23);
            x35 = (x24 == 3);
            if (!x35) {
                x35 = (x24 == 2);
                if (x35) {
                    x35 = (x19 == 1);
                }
            }
            if (x35) {
                {
                    TValue *slot = &x11->array[x12 - 1];
                    setivalue(slot, 1);
                }
            } else {
                {
                    TValue *slot = &x11->array[x12 - 1];
                    setivalue(slot, 0);
                }
            }
        }
        PALLENE_INT_FOR_LOOP_END
    }
    PALLENE_INT_FOR_LOOP_END
}

/* ------- */
/* Exports */
/* ------- */

static int function_01_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 0)) {
        pallene_runtime_arity_error(L, "$init", 0, nargs);
    }
    	
    function_01(L, G, L->top);
    return 0;
}

static int function_02_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 2)) {
        pallene_runtime_arity_error(L, "new_canvas", 2, nargs);
    }
    	
    lua_Integer x1;
    lua_Integer x2;
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 1)))) {
        pallene_runtime_tag_check_error(L,
            5, LUA_TNUMINT, rawtt(s2v(base + 1)),
            "argument '%s'", "N");
    }
    x1 = ivalue(s2v(base + 1));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 2)))) {
        pallene_runtime_tag_check_error(L,
            5, LUA_TNUMINT, rawtt(s2v(base + 2)),
            "argument '%s'", "M");
    }
    x2 = ivalue(s2v(base + 2));
    	
    Table *ret1;
    ret1 = function_02(L, G, L->top, x1, x2);
    sethvalue(L, s2v(L->top), ret1);
    L->top++;
    return 1;
}

static int function_03_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 2)) {
        pallene_runtime_arity_error(L, "wrap", 2, nargs);
    }
    	
    lua_Integer x1;
    lua_Integer x2;
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 1)))) {
        pallene_runtime_tag_check_error(L,
            18, LUA_TNUMINT, rawtt(s2v(base + 1)),
            "argument '%s'", "i");
    }
    x1 = ivalue(s2v(base + 1));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 2)))) {
        pallene_runtime_tag_check_error(L,
            18, LUA_TNUMINT, rawtt(s2v(base + 2)),
            "argument '%s'", "N");
    }
    x2 = ivalue(s2v(base + 2));
    	
    lua_Integer ret1;
    ret1 = function_03(L, G, L->top, x1, x2);
    setivalue(s2v(L->top), ret1);
    L->top++;
    return 1;
}

static int function_04_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 3)) {
        pallene_runtime_arity_error(L, "draw", 3, nargs);
    }
    	
    lua_Integer x1;
    lua_Integer x2;
    Table *x3;
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 1)))) {
        pallene_runtime_tag_check_error(L,
            23, LUA_TNUMINT, rawtt(s2v(base + 1)),
            "argument '%s'", "N");
    }
    x1 = ivalue(s2v(base + 1));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 2)))) {
        pallene_runtime_tag_check_error(L,
            23, LUA_TNUMINT, rawtt(s2v(base + 2)),
            "argument '%s'", "M");
    }
    x2 = ivalue(s2v(base + 2));
    	
    if (PALLENE_UNLIKELY(!ttistable(s2v(base + 3)))) {
        pallene_runtime_tag_check_error(L,
            23, LUA_TTABLE, rawtt(s2v(base + 3)),
            "argument '%s'", "cells");
    }
    x3 = hvalue(s2v(base + 3));
    	
    function_04(L, G, L->top, x1, x2, x3);
    return 0;
}

static int function_05_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 6)) {
        pallene_runtime_arity_error(L, "spawn", 6, nargs);
    }
    	
    lua_Integer x1;
    lua_Integer x2;
    Table *x3;
    Table *x4;
    lua_Integer x5;
    lua_Integer x6;
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 1)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TNUMINT, rawtt(s2v(base + 1)),
            "argument '%s'", "N");
    }
    x1 = ivalue(s2v(base + 1));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 2)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TNUMINT, rawtt(s2v(base + 2)),
            "argument '%s'", "M");
    }
    x2 = ivalue(s2v(base + 2));
    	
    if (PALLENE_UNLIKELY(!ttistable(s2v(base + 3)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TTABLE, rawtt(s2v(base + 3)),
            "argument '%s'", "cells");
    }
    x3 = hvalue(s2v(base + 3));
    	
    if (PALLENE_UNLIKELY(!ttistable(s2v(base + 4)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TTABLE, rawtt(s2v(base + 4)),
            "argument '%s'", "shape");
    }
    x4 = hvalue(s2v(base + 4));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 5)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TNUMINT, rawtt(s2v(base + 5)),
            "argument '%s'", "top");
    }
    x5 = ivalue(s2v(base + 5));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 6)))) {
        pallene_runtime_tag_check_error(L,
            41, LUA_TNUMINT, rawtt(s2v(base + 6)),
            "argument '%s'", "left");
    }
    x6 = ivalue(s2v(base + 6));
    	
    function_05(L, G, L->top, x1, x2, x3, x4, x5, x6);
    return 0;
}

static int function_06_lua(lua_State *L)
{
    StackValue *base = L->ci->func;
    CClosure *func = clCvalue(s2v(base));
    Udata *G = uvalue(&func->upvalue[0]);
    	
    int nargs = lua_gettop(L);
    if (PALLENE_UNLIKELY(nargs != 4)) {
        pallene_runtime_arity_error(L, "step", 4, nargs);
    }
    	
    lua_Integer x1;
    lua_Integer x2;
    Table *x3;
    Table *x4;
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 1)))) {
        pallene_runtime_tag_check_error(L,
            55, LUA_TNUMINT, rawtt(s2v(base + 1)),
            "argument '%s'", "N");
    }
    x1 = ivalue(s2v(base + 1));
    	
    if (PALLENE_UNLIKELY(!ttisinteger(s2v(base + 2)))) {
        pallene_runtime_tag_check_error(L,
            55, LUA_TNUMINT, rawtt(s2v(base + 2)),
            "argument '%s'", "M");
    }
    x2 = ivalue(s2v(base + 2));
    	
    if (PALLENE_UNLIKELY(!ttistable(s2v(base + 3)))) {
        pallene_runtime_tag_check_error(L,
            55, LUA_TTABLE, rawtt(s2v(base + 3)),
            "argument '%s'", "curr_cells");
    }
    x3 = hvalue(s2v(base + 3));
    	
    if (PALLENE_UNLIKELY(!ttistable(s2v(base + 4)))) {
        pallene_runtime_tag_check_error(L,
            55, LUA_TTABLE, rawtt(s2v(base + 4)),
            "argument '%s'", "next_cells");
    }
    x4 = hvalue(s2v(base + 4));
    	
    function_06(L, G, L->top, x1, x2, x3, x4);
    return 0;
}

int luaopen_benchmarks_conway_pallene_mod(lua_State *L)
{
    luaL_checkversion(L);
    	
    lua_newuserdatauv(L, 0, 7);
    int globals = lua_gettop(L);
    	
    lua_createtable(L, 6, 0);
    int closures = lua_gettop(L);
    	
    lua_newtable(L);
    int export_table = lua_gettop(L);
    	
    /* Closures */
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_01_lua, 1);
    lua_seti(L, closures, 1);
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_02_lua, 1);
    lua_seti(L, closures, 2);
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_03_lua, 1);
    lua_seti(L, closures, 3);
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_04_lua, 1);
    lua_seti(L, closures, 4);
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_05_lua, 1);
    lua_seti(L, closures, 5);
    	
    lua_pushvalue(L, globals);
    lua_pushcclosure(L, function_06_lua, 1);
    lua_seti(L, closures, 6);
    	
    /* Global values */
    	
    lua_pushstring(L, "");
    lua_setiuservalue(L, globals, 1);
    	
    lua_pushstring(L, "|");
    lua_setiuservalue(L, globals, 2);
    	
    lua_pushstring(L, "*");
    lua_setiuservalue(L, globals, 3);
    	
    lua_pushstring(L, " ");
    lua_setiuservalue(L, globals, 4);
    	
    lua_pushstring(L, "|\n");
    lua_setiuservalue(L, globals, 5);
    	
    // Run toplevel statements & initialize globals
    lua_geti(L, closures, 1);
    lua_call(L, 0, 0);
    	
    /* Exports */
    	
    lua_pushstring(L, "new_canvas");
    lua_geti(L, closures, 2);
    lua_settable(L, export_table);
    	
    lua_pushstring(L, "wrap");
    lua_geti(L, closures, 3);
    lua_settable(L, export_table);
    	
    lua_pushstring(L, "draw");
    lua_geti(L, closures, 4);
    lua_settable(L, export_table);
    	
    lua_pushstring(L, "spawn");
    lua_geti(L, closures, 5);
    lua_settable(L, export_table);
    	
    lua_pushstring(L, "step");
    lua_geti(L, closures, 6);
    lua_settable(L, export_table);
    	
    lua_pushvalue(L, export_table);
    return 1;
}

